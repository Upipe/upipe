#ifndef __HW_CONFIG_H
#define __HW_CONFIG_H
#include "csr.h"

#define MINIMAL_GATEWARE_REVISION "2019-08-15"

/* targets identifiers */
#define FALCON9_FPGA_IDENTIFIER "Falcon9"
#define NO_SECRETS
#define DUO2_FPGA_IDENTIFIER "Duo2"
#define MINI_4K_FPGA_IDENTIFIER "Mini 4k"
#define SDI_4K_FPGA_IDENTIFIER "SDI 4k"
#undef NO_SECRETS

/* pci */
#define PCIE_FPGA_VENDOR_ID 0x1bb8
#define PCIE_FPGA_DEVICE_ID_X1 0x7021
#define PCIE_FPGA_DEVICE_ID_X2 0x7022
#define PCIE_FPGA_DEVICE_ID_X4 0x7024

/* /!\ keep in sync with csr.h  /!\ */

/* dma */
#define DMA_IRQ_DISABLE  (1<<24)
#define DMA_LAST_DISABLE (1<<25)

#define DMA_CHANNEL_COUNT SDI_CHANNELS
#define DMA_BUFFER_PER_IRQ 32
#define DMA_BUFFER_COUNT 256
#define DMA_BUFFER_SIZE 8192
#define DMA_BUFFER_TOTAL_SIZE (DMA_BUFFER_COUNT*DMA_BUFFER_SIZE)
//#define DMA_BUFFER_ALIGNED


/* pcie dma */
#define PCIE_DMA_WRITER_ENABLE_OFFSET 0x0000
#define PCIE_DMA_WRITER_TABLE_VALUE_OFFSET 0x0004
#define PCIE_DMA_WRITER_TABLE_WE_OFFSET 0x000c
#define PCIE_DMA_WRITER_TABLE_LOOP_PROG_N_OFFSET 0x0010
#define PCIE_DMA_WRITER_TABLE_LOOP_STATUS_OFFSET 0x0014
#define PCIE_DMA_WRITER_TABLE_LEVEL_OFFSET 0x0018
#define PCIE_DMA_WRITER_TABLE_FLUSH_OFFSET 0x001c
#define PCIE_DMA_READER_ENABLE_OFFSET 0x0020
#define PCIE_DMA_READER_TABLE_VALUE_OFFSET 0x0024
#define PCIE_DMA_READER_TABLE_WE_OFFSET 0x002c
#define PCIE_DMA_READER_TABLE_LOOP_PROG_N_OFFSET 0x0030
#define PCIE_DMA_READER_TABLE_LOOP_STATUS_OFFSET 0x0034
#define PCIE_DMA_READER_TABLE_LEVEL_OFFSET 0x0038
#define PCIE_DMA_READER_TABLE_FLUSH_OFFSET 0x003c
#define PCIE_DMA_LOOPBACK_ENABLE_OFFSET 0x0040

/* sdi */
#define SDI_CORE_TX_RESET_OFFSET 0x00000
#define SDI_CORE_TX_PLLSEL_OFFSET 0x00004
#define SDI_CORE_TX_MODE_OFFSET 0x00008
#define SDI_CORE_TX_PACK_OFFSET 0x000c
#define SDI_CORE_TX_CRC_OFFSET 0x00010
#define SDI_CORE_TX_SLEW_OFFSET 0x00014
#define SDI_CORE_TX_TXEN_OFFSET 0x00018
#define SDI_CORE_TX_CE_ERROR_OFFSET 0x0001c
#define SDI_CORE_TX_PI_OFFSET 0x00020

#define SDI_CORE_RX_RESET_OFFSET 0x00024
#define SDI_CORE_RX_MODE_OFFSET 0x00028
#define SDI_CORE_RX_MODE_ENABLE_OFFSET 0x0002c
#define SDI_CORE_RX_PACK_OFFSET 0x00030
#define SDI_CORE_RX_CRC_OFFSET 0x00034
#define SDI_CORE_RX_LOCKED_OFFSET 0x00038
#define SDI_CORE_RX_FAMILY_OFFSET 0x0003c
#define SDI_CORE_RX_RATE_OFFSET 0x00040
#define SDI_CORE_RX_SCAN_OFFSET 0x00044
#define SDI_CORE_RX_M_OFFSET 0x00048

#define SDI_CORE_LOOPBACK_OFFSET 0x0004c

#define SDI_CORE_CLK_FREQ_VALUE_OFFSET 0x00050
#define SDI_CORE_CLK_COUNTER_LATCH_OFFSET 0x00054
#define SDI_CORE_CLK_COUNTER_VALUE_OFFSET 0x00058

#define SDI_CORE_SD_PATTERN_ENABLE_OFFSET 0x00060
#define SDI_CORE_SD_PATTERN_FORMAT_OFFSET 0x00064
#define SDI_CORE_SD_PATTERN_PATTERN_OFFSET 0x00068
#define SDI_CORE_SD_PATTERN_RELEASE_ON_SYNCHRO_OFFSET 0x0006c

#define SDI_CORE_HD_3G_PATTERN_ENABLE_OFFSET 0x00070
#define SDI_CORE_HD_3G_PATTERN_FORMAT_OFFSET 0x00074
#define SDI_CORE_HD_3G_PATTERN_PATTERN_OFFSET 0x00078
#define SDI_CORE_HD_3G_PATTERN_RELEASE_ON_SYNCHRO_OFFSET 0x0007c

#define SDI_CORE_TX_SYNC_ENABLE_OFFSET 0x00080
#define SDI_CORE_TX_SYNC_BYPASS_OFFSET 0x00084
#define SDI_CORE_TX_SYNC_RELEASE_ON_SYNCHRO_OFFSET 0x00088
#define SDI_CORE_RX_SYNC_ENABLE_OFFSET 0x0008c
#define SDI_CORE_RX_SYNC_BYPASS_OFFSET 0x00090

#define SDI_CORE_TX_UNDERFLOW_RESET_OFFSET 0x00094
#define SDI_CORE_TX_UNDERFLOW_COUNT_OFFSET 0x00098
#define SDI_CORE_RX_OVERFLOW_RESET_OFFSET 0x0009c
#define SDI_CORE_RX_OVERFLOW_COUNT_OFFSET 0x000a0

#endif /* __HW_CONFIG_H */
